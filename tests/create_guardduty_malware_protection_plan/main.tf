# Creates a GuardDuty Malware Protection for this account.
# - Creates a GuardDuty detector for this account
# - Creates a GuardDuty Malware Protection for this account
module "malware_protection_plan" {
  source = "../../"

  enable = true

  protected_buckets = [
    "sample-bucket-1",
    "sample-bucket-2"
  ]

  role_arn = "arn:${data.aws_partition.current.partition}:iam::${data.aws_caller_identity.current.account_id}:role/existing-sample-role"
}

data "aws_partition" "current" {}

data "aws_caller_identity" "current" {}
